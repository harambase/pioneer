webpackJsonp([22],{400:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=e(662),i=e(776),o=e(150),r=o(a.a,i.a,!1,null,null,null);s.default=r.exports},442:function(t,s,e){"use strict";var a=e(151),i=e.n(a),o=[],r=[{key:"index",label:"序号",class:"text-center"},{key:"studentId",label:"学生ID"},{key:"sname",label:"姓名"},{key:"maxCredits",label:"学分上限"},{key:"complete",label:"已完成学分"},{key:"progress",label:"进行中学分"},{key:"incomplete",label:"未完成学分"},{key:"actions",label:"操作"}],l=[{key:"index",label:"序号",class:"text-center"},{key:"studentId",label:"学生ID"},{key:"sname",label:"姓名"},{key:"trialPeriod",label:"试读时间"},{key:"tel",label:"电话"},{key:"qq",label:"QQ"},{key:"gender",label:"性别"},{key:"dorm",label:"宿舍"},{key:"actions",label:"操作"}];s.a={name:"c-addStudentTable",props:["mode","crn","cname","credit"],data:function(){return{msg:"",showModal:!1,headerBgVariant:"",sname:"",field:"info"==this.mode?l:r,currentPage:1,perPage:15,totalRows:0,pageOptions:[15,25,35],sortBy:"student_id",sortDesc:!1,filter:null,items:o,option:{prereq:!1,time:!1,capacity:!1,override:!1},basePath:basePath,showChangeTime:!1,trialPeriod:[]}},computed:{sortOptions:function(){return this.field.filter(function(t){return t.sortable}).map(function(t){return{text:t.label,value:t.key}})}},methods:{displayDate:function(t){return isNotEmpty(t)?(t=JSON.parse(t),console.log(t[0]),date2Str(new Date(t[0]),"yyyy-MM-dd")+"至"+date2Str(new Date(t[1]),"yyyy-MM-dd")):""},handleOk:function(t){t.preventDefault(),this.$router.go(0)},updateTrailPeriod:function(t,s){var e=this;i.a.post("/student/"+t+"/trial",s).then(function(t){2001===t.data.code?(e.msg=t.data.msg,e.showModal=!0,e.headerBgVariant="success",e.initTable(),e.showChangeTime=!1):(e.msg=t.data.msg,e.showModal=!0,e.headerBgVariant="danger")})},onFiltered:function(t){this.totalRows=t.length,this.currentPage=1},initTable:function(){this.$refs.addStudentTable.refresh()},addStudentTable:function(t){var s=this;this.isBusy=!0;var e="/student?start="+t.currentPage+"&status=1&length="+t.perPage+"&orderCol=";switch(t.sortBy){case"studentId":e+="student_id";break;case"maxCredits":e+="max_credits";break;default:e+=t.sortBy}return this.isNotEmpty(t.filter)&&(e+="&search="+t.filter),t.sortDesc?e+="&order=desc":e+="&order=asc",i.a.get(e).then(function(t){var e=t.data.data;return s.totalRows=t.data.recordsTotal,e||[]})},isNotEmpty:function(t){return""!==t&&void 0!==t&&null!==t},addStudent2Course:function(t){var s=this;i.a.put("/course/"+this.crn+"/student/"+t,this.option).then(function(t){2001===t.data.code?(s.msg=t.data.msg,s.showModal=!0,s.headerBgVariant="success"):(s.msg=t.data.msg,s.showModal=!0,s.headerBgVariant="danger")})},doUpdate:function(t,s){var e=this;this.$validator.validateAll().then(function(a){var o={studentId:t,maxCredits:s};console.log(o),i.a.put("/student/"+t,o).then(function(t){2001===t.data.code?(e.msg=t.data.msg,e.showModal=!0,e.headerBgVariant="success"):(e.msg=t.data.msg,e.showModal=!0,e.headerBgVariant="danger")})})}}}},489:function(t,s,e){"use strict";var a=e(442),i=e(490),o=e(150),r=o(a.a,i.a,!1,null,null,null);s.a=r.exports},490:function(t,s,e){"use strict";var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("b-container",{attrs:{fluid:""}},[e("b-row",[e("b-col",{staticClass:"my-1",attrs:{md:"1"}},[e("legend",{staticClass:"col-form-legend"},[t._v("每页显示：")])]),t._v(" "),e("b-col",{staticClass:"my-1",attrs:{md:"3"}},[e("b-form-group",[e("b-form-select",{attrs:{options:t.pageOptions},model:{value:t.perPage,callback:function(s){t.perPage=s},expression:"perPage"}})],1)],1),t._v(" "),e("b-col",{staticClass:"my-1",attrs:{md:"4"}}),t._v(" "),e("b-col",{staticClass:"my-1",attrs:{md:"4"}},[e("b-form-group",[e("b-input-group",[e("b-input-group-button",[e("div",{staticClass:"mt-2"},[t._v("\n              搜索：\n            ")])]),t._v(" "),e("b-form-input",{model:{value:t.filter,callback:function(s){t.filter=s},expression:"filter"}}),t._v(" "),e("b-input-group-button",[e("b-button",{attrs:{variant:"danger",disabled:!t.filter},on:{click:function(s){t.filter=""}}},[t._v("重置")])],1)],1)],1)],1)],1),t._v(" "),e("b-table",{ref:"addStudentTable",attrs:{"show-empty":"",stacked:"sm",small:!0,striped:!0,fixed:!0,hover:!0,items:t.addStudentTable,fields:t.field,"current-page":t.currentPage,"per-page":t.perPage,filter:t.filter,"sort-by":t.sortBy,"sort-desc":t.sortDesc,isBusy:!1},on:{"update:sortBy":function(s){t.sortBy=s},"update:sortDesc":function(s){t.sortDesc=s},filtered:t.onFiltered},scopedSlots:t._u([{key:"index",fn:function(s){return[t._v("\n      "+t._s((t.currentPage-1)*t.perPage+1+s.index)+"\n    ")]}},{key:"studentId",fn:function(s){return[e("b-row",[e("b-col",{attrs:{md:"3"}},[t.isNotEmpty(s.item.profile)?e("img",{staticClass:"img-avatar",staticStyle:{width:"30px",height:"30px"},attrs:{src:t.basePath+"/static"+JSON.parse(s.item.profile).path}}):e("img",{staticClass:"img-avatar",staticStyle:{width:"40px",height:"40px"},attrs:{src:t.basePath+"/static/img/logo.png"}})]),t._v(" "),e("b-col",{staticClass:"mt-1",staticStyle:{"font-size":"11px"},attrs:{md:"9"}},[t._v("\n          "+t._s(s.value)+"\n        ")])],1)]}},{key:"trialPeriod",fn:function(s){return[e("p",[t._v(t._s(t.displayDate(s.item.trialPeriod)))])]}},{key:"actions",fn:function(s){return[e("b-nav",{attrs:{pills:""}},[e("b-nav-item-dropdown",{attrs:{text:"操作"}},["credit"===t.mode?e("b-dropdown-item",{on:{click:function(t){return t.stopPropagation(),s.toggleDetails(t)}}},[e("i",{staticClass:"fa fa-pen",staticStyle:{color:"red"},attrs:{title:"修改学分上限"}}),t._v("修改学分上限\n          ")]):t._e(),t._v(" "),"student"===t.mode?e("b-dropdown-item",{on:{click:function(t){return t.stopPropagation(),s.toggleDetails(t)}}},[e("i",{staticClass:"fa fa-envelope",staticStyle:{color:"red"},attrs:{title:"添加该学生"}}),t._v("添加该学生\n          ")]):t._e(),t._v(" "),e("b-dropdown-item",{on:{click:function(t){return t.stopPropagation(),s.toggleDetails(t)}}},[e("i",{staticClass:"fa fa-pencil",staticStyle:{color:"red"},attrs:{title:"修改学生信息"}}),t._v("修改学生信息\n          ")])],1)],1)]}},{key:"row-details",fn:function(s){return["credit"===t.mode?e("b-card",[e("b-list-group",[e("b-list-group-item",{staticClass:"flex-column align-items-start",attrs:{title:"编辑学分",disabled:""}},[e("div",{staticClass:"d-flex w-100 justify-content-between"},[e("h5",{staticClass:"mb-1"},[t._v("学生 "),e("strong",[t._v(t._s(s.item.sname))]),t._v(" 的学分完成情况")]),t._v(" "),e("small",{staticClass:"text-muted"},[t._v("学生ID："+t._s(s.item.studentId))])]),t._v(" "),e("hr"),t._v(" "),e("div",{staticClass:"mr-1"},[e("dl",{staticClass:"row"},[e("dt",{staticClass:"col-sm-1"},[t._v("学分上限:")]),t._v(" "),e("dd",{staticClass:"col-sm-2"},[e("input",{directives:[{name:"model",rawName:"v-model",value:s.item.maxCredits,expression:"row.item.maxCredits"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],class:{"form-control":!0,"is-invalid":t.errors.has("maxCredits")},attrs:{id:"maxCredits",name:"maxCredits"},domProps:{value:s.item.maxCredits},on:{input:function(e){e.target.composing||t.$set(s.item,"maxCredits",e.target.value)}}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("maxCredits"),expression:"errors.has('maxCredits')"}],staticClass:"invalid-tooltip"},[t._v(t._s(t.errors.first("maxCredits"))+"\n                  ")])]),t._v(" "),e("dt",{staticClass:"col-sm-1"},[t._v("已完成学分:")]),t._v(" "),e("dd",{staticClass:"col-sm-2"},[t._v(t._s(s.item.complete))]),t._v(" "),e("dt",{staticClass:"col-sm-1"},[t._v("进行中学分:")]),t._v(" "),e("dd",{staticClass:"col-sm-2"},[t._v(t._s(s.item.progress))]),t._v(" "),e("dt",{staticClass:"col-sm-1"},[t._v("未完成学分:")]),t._v(" "),e("dd",{staticClass:"col-sm-2"},[t._v(t._s(s.item.incomplete))])]),t._v(" "),e("hr"),t._v(" "),e("dl",{staticClass:"row"},[e("dt",{staticClass:"col-sm-1"},[t._v("操作:")]),t._v(" "),e("dd",{staticClass:"col-sm-5"},[e("b-button",{staticClass:"btn btn-danger",attrs:{size:"sm"},on:{click:function(e){e.stopPropagation(),t.doUpdate(s.item.studentId,s.item.maxCredits)}}},[t._v("\n                    提交\n                  ")])],1)])])])],1)],1):t._e(),t._v(" "),"student"===t.mode?e("b-card",[e("b-list-group",[e("b-list-group-item",{staticClass:"flex-column align-items-start",attrs:{title:"添加该学生",disabled:""}},[e("div",{staticClass:"d-flex w-100 justify-content-between"},[e("h5",{staticClass:"mb-1"},[t._v("添加学生 "),e("strong",[t._v(t._s(s.item.sname))]),t._v(" 进入 "),e("strong",[t._v(t._s(t.cname))]),t._v(" 课程")]),t._v(" "),e("small",{staticClass:"text-muted"},[t._v("学生ID："+t._s(s.item.studentId))])]),t._v(" "),e("hr"),t._v(" "),e("div",{staticClass:"mr-1"},[e("h5",{staticClass:"mb-1"},[t._v("添加选项:")]),t._v(" "),e("dl",{staticClass:"row"},[e("dt",{staticClass:"col-sm-2"},[t._v("添加此学生，无视任何冲突:")]),t._v(" "),e("dd",{staticClass:"col-sm-1"},[e("div",{staticClass:"custom-control custom-checkbox custom-control-inline"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.option.override,expression:"option.override"}],staticClass:"custom-control-input",attrs:{type:"checkbox",value:"s",id:"override",name:"type"},domProps:{checked:Array.isArray(t.option.override)?t._i(t.option.override,"s")>-1:t.option.override},on:{change:function(s){var e=t.option.override,a=s.target,i=!!a.checked;if(Array.isArray(e)){var o=t._i(e,"s");a.checked?o<0&&t.$set(t.option,"override",e.concat(["s"])):o>-1&&t.$set(t.option,"override",e.slice(0,o).concat(e.slice(o+1)))}else t.$set(t.option,"override",i)}}}),t._v(" "),e("label",{staticClass:"custom-control-label",attrs:{for:"override"}},[t._v("是")])])]),t._v(" "),e("dt",{staticClass:"col-sm-2"},[t._v("添加此学生，即使未完成预选课程:")]),t._v(" "),e("dd",{staticClass:"col-sm-1"},[e("div",{staticClass:"custom-control custom-checkbox custom-control-inline"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.option.prereq,expression:"option.prereq"}],staticClass:"custom-control-input",attrs:{type:"checkbox",value:"s",id:"prereq",name:"type"},domProps:{checked:Array.isArray(t.option.prereq)?t._i(t.option.prereq,"s")>-1:t.option.prereq},on:{change:function(s){var e=t.option.prereq,a=s.target,i=!!a.checked;if(Array.isArray(e)){var o=t._i(e,"s");a.checked?o<0&&t.$set(t.option,"prereq",e.concat(["s"])):o>-1&&t.$set(t.option,"prereq",e.slice(0,o).concat(e.slice(o+1)))}else t.$set(t.option,"prereq",i)}}}),t._v(" "),e("label",{staticClass:"custom-control-label",attrs:{for:"prereq"}},[t._v("是")])])]),t._v(" "),e("dt",{staticClass:"col-sm-2"},[t._v("添加此学生，即使有时间冲突:")]),t._v(" "),e("dd",{staticClass:"col-sm-1"},[e("div",{staticClass:"custom-control custom-checkbox custom-control-inline"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.option.time,expression:"option.time"}],staticClass:"custom-control-input",attrs:{type:"checkbox",value:"s",id:"time",name:"type"},domProps:{checked:Array.isArray(t.option.time)?t._i(t.option.time,"s")>-1:t.option.time},on:{change:function(s){var e=t.option.time,a=s.target,i=!!a.checked;if(Array.isArray(e)){var o=t._i(e,"s");a.checked?o<0&&t.$set(t.option,"time",e.concat(["s"])):o>-1&&t.$set(t.option,"time",e.slice(0,o).concat(e.slice(o+1)))}else t.$set(t.option,"time",i)}}}),t._v(" "),e("label",{staticClass:"custom-control-label",attrs:{for:"time"}},[t._v("是")])])]),t._v(" "),e("dt",{staticClass:"col-sm-2"},[t._v("添加此学生，即使已经达到课程人数上限:")]),t._v(" "),e("dd",{staticClass:"col-sm-1"},[e("div",{staticClass:"custom-control custom-checkbox custom-control-inline"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.option.capacity,expression:"option.capacity"}],staticClass:"custom-control-input",attrs:{type:"checkbox",value:"s",id:"capacity",name:"type"},domProps:{checked:Array.isArray(t.option.capacity)?t._i(t.option.capacity,"s")>-1:t.option.capacity},on:{change:function(s){var e=t.option.capacity,a=s.target,i=!!a.checked;if(Array.isArray(e)){var o=t._i(e,"s");a.checked?o<0&&t.$set(t.option,"capacity",e.concat(["s"])):o>-1&&t.$set(t.option,"capacity",e.slice(0,o).concat(e.slice(o+1)))}else t.$set(t.option,"capacity",i)}}}),t._v(" "),e("label",{staticClass:"custom-control-label",attrs:{for:"capacity"}},[t._v("是")])])])]),t._v(" "),e("hr"),t._v(" "),e("dl",{staticClass:"row"},[e("dt",{staticClass:"col-sm-1"},[t._v("操作:")]),t._v(" "),e("dd",{staticClass:"col-sm-5"},[e("b-button",{staticClass:"btn btn-danger",attrs:{size:"sm"},on:{click:function(e){e.stopPropagation(),t.addStudent2Course(s.item.studentId)}}},[t._v("\n                    添加\n                  ")])],1)])])])],1)],1):t._e(),t._v(" "),"info"===t.mode?e("b-card",[e("b-list-group",[e("b-list-group-item",{staticClass:"flex-column align-items-start",attrs:{title:"学生表"}},[e("div",{staticClass:"d-flex w-100 justify-content-between"},[e("h5",{staticClass:"mb-1"},[t._v("学生 "),e("strong",[t._v(t._s(s.item.sname))]),t._v(" 的基本信息\n                "),e("small",{staticClass:"text-muted"},[t._v("学生ID："+t._s(s.item.studentId))])])]),t._v(" "),e("hr"),t._v(" "),e("div",{staticClass:"mr-1"},[e("b-row",[e("b-col",{staticClass:"my-1",attrs:{md:"9"}},[e("div",{staticClass:"mr-1"},[e("dl",{staticClass:"row"},[e("dt",{staticClass:"col-sm-1"},[t._v("QQ:")]),t._v(" "),e("dd",{staticClass:"col-sm-2"},[t._v(t._s(s.item.qq))]),t._v(" "),e("dt",{staticClass:"col-sm-1"},[t._v("电话:")]),t._v(" "),e("dd",{staticClass:"col-sm-2"},[t._v(t._s(s.item.tel))]),t._v(" "),e("dt",{staticClass:"col-sm-1"},[t._v("微信:")]),t._v(" "),e("dd",{staticClass:"col-sm-2"},[t._v(t._s(s.item.weChat))])]),t._v(" "),e("dl",{staticClass:"row"},[e("dt",{staticClass:"col-sm-1"},[t._v("性别:")]),t._v(" "),e("dd",{staticClass:"col-sm-2"},[t._v(t._s(s.item.gender))]),t._v(" "),e("dt",{staticClass:"col-sm-1"},[t._v("宿舍:")]),t._v(" "),e("dd",{staticClass:"col-sm-2"},[t._v(t._s(s.item.dorm))])]),t._v(" "),e("p",[t._v("暂不支持修改以上信息")]),t._v(" "),e("hr"),t._v(" "),e("dl",{staticClass:"row"},[e("dt",{staticClass:"col-sm-1"},[t._v("试读时间:")]),t._v(" "),e("dd",{staticClass:"col-sm-2"},[t._v("\n                        "+t._s(t.displayDate(s.item.trialPeriod))+"\n                      ")])]),t._v(" "),t.showChangeTime?t._e():e("dl",{staticClass:"row"},[e("dt",{staticClass:"col-sm-1"},[t._v("操作:")]),t._v(" "),e("dd",{staticClass:"col-sm-5"},[e("b-button",{staticClass:"btn btn-danger",attrs:{size:"sm"},on:{click:function(s){s.stopPropagation(),t.showChangeTime=!0}}},[t._v("\n                          修改试读时间\n                        ")])],1)]),t._v(" "),t.showChangeTime?e("dl",{staticClass:"row"},[e("dt",{staticClass:"col-sm-3"},[e("el-date-picker",{staticClass:"form-control",attrs:{type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期",size:"mini"},model:{value:t.trialPeriod,callback:function(s){t.trialPeriod=s},expression:"trialPeriod"}})],1),t._v(" "),e("dd",{staticClass:"col-sm-5"},[e("b-button",{staticClass:"btn btn-danger",attrs:{size:"sm"},on:{click:function(e){e.stopPropagation(),t.updateTrailPeriod(s.item.studentId,t.trialPeriod)}}},[t._v("\n                          修改试读时间\n                        ")])],1)]):t._e()])]),t._v(" "),e("b-col",{staticClass:"my-1",attrs:{md:"3"}},[t.isNotEmpty(s.item.profile)?e("img",{staticClass:"img-avatar",staticStyle:{width:"70%"},attrs:{src:t.basePath+"/static"+JSON.parse(s.item.profile).path}}):e("img",{staticClass:"img-avatar",staticStyle:{width:"70%"},attrs:{src:t.basePath+"/static/img/logo.png"}})])],1)],1)])],1)],1):t._e()]}}])}),t._v(" "),e("b-row",[e("b-col",{staticClass:"my-1",attrs:{md:"6"}},[e("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage},model:{value:t.currentPage,callback:function(s){t.currentPage=s},expression:"currentPage"}})],1),t._v(" "),e("b-col",{staticClass:"my-1",attrs:{md:"6"}},[e("p",{staticClass:"text-muted",staticStyle:{"text-align":"right"}},[t._v(" 显示 "+t._s((t.currentPage-1)*t.perPage+1)+" 至 "+t._s((t.currentPage-1)*t.perPage+t.perPage<=t.totalRows?(t.currentPage-1)*t.perPage+t.perPage:t.totalRows)+" 条 ，总共 "+t._s(t.totalRows)+" 条数据 ")])])],1),t._v(" "),e("b-modal",{attrs:{size:"sm","header-bg-variant":t.headerBgVariant,"ok-only":"","ok-title":"关闭",centered:"",title:"消息"},on:{ok:t.handleOk},model:{value:t.showModal,callback:function(s){t.showModal=s},expression:"showModal"}},[e("div",{staticClass:"d-block text-center"},[e("h4",[t._v(t._s(t.msg))])])])],1)},i=[],o={render:a,staticRenderFns:i};s.a=o},662:function(t,s,e){"use strict";var a=e(489);s.a={name:"Credit",components:{CAddStudentTable:a.a}}},776:function(t,s,e){"use strict";var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"animated fadeIn"},[e("b-row",[e("b-col",{attrs:{md:"12"}},[e("b-col",{attrs:{cols:"12"}},[e("b-card",{attrs:{"header-tag":"header","footer-tag":"footer"}},[e("div",{attrs:{slot:"header"},slot:"header"},[e("i",{attrs:{className:"fa fa-align-justify"}}),e("strong",[t._v("学生列表")])]),t._v(" "),e("CAddStudentTable",{attrs:{mode:"credit"}})],1)],1)],1)],1)],1)},i=[],o={render:a,staticRenderFns:i};s.a=o}});
//# sourceMappingURL=22.0eee7d57f9cb16cef28c.js.map