webpackJsonp([17],{413:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s(657),o=s(766),r=s(21),i=r(a.a,o.a,!1,null,null,null);e.default=i.exports},455:function(t,e,s){"use strict";var a=s(138),o=s.n(a),r=[],i=[{key:"index",label:"序号",class:"text-center"},{key:"studentId",label:"学生ID"},{key:"sname",label:"姓名"},{key:"maxCredits",label:"学分上限"},{key:"complete",label:"已完成学分"},{key:"progress",label:"进行中学分"},{key:"incomplete",label:"未完成学分"},{key:"actions",label:"操作"}];e.a={name:"c-addStudentTable",props:["mode","crn","cname","credit"],data:function(){return{msg:"",showModal:!1,headerBgVariant:"",sname:"",field:i,currentPage:1,perPage:10,totalRows:0,pageOptions:[5,10,15],sortBy:"student_id",sortDesc:!1,filter:null,items:r,option:{prereq:!1,time:!1,capacity:!1,override:!1}}},computed:{sortOptions:function(){return this.field.filter(function(t){return t.sortable}).map(function(t){return{text:t.label,value:t.key}})}},methods:{handleOk:function(t){t.preventDefault(),this.$router.go(0)},onFiltered:function(t){this.totalRows=t.length,this.currentPage=1},initTable:function(){this.$refs.addStudentTable.refresh()},addStudentTable:function(t){var e=this;this.isBusy=!0;var s="/student?start="+t.currentPage+"&status=1&length="+t.perPage+"&orderCol=";switch(t.sortBy){case"studentId":s+="student_id";break;case"maxCredits":s+="max_credits";break;default:s+=t.sortBy}return this.isNotEmpty(t.filter)&&(s+="&search="+t.filter),t.sortDesc?s+="&order=desc":s+="&order=asc",o.a.get(s).then(function(t){var s=t.data.data;return e.totalRows=t.data.recordsTotal,s||[]})},isNotEmpty:function(t){return""!==t&&void 0!==t&&null!==t},addStudent2Course:function(t){var e=this;o.a.put("/course/"+this.crn+"/student/"+t,this.option).then(function(t){2001===t.data.code?(e.msg=t.data.msg,e.showModal=!0,e.headerBgVariant="success"):(e.msg=t.data.msg,e.showModal=!0,e.headerBgVariant="danger")})},doUpdate:function(t,e){var s=this;this.$validator.validateAll().then(function(a){var r={studentId:t,maxCredits:e};console.log(r),o.a.put("/student/"+t,r).then(function(t){2001===t.data.code?(s.msg=t.data.msg,s.showModal=!0,s.headerBgVariant="success"):(s.msg=t.data.msg,s.showModal=!0,s.headerBgVariant="danger")})})}}}},500:function(t,e,s){"use strict";var a=s(455),o=s(501),r=s(21),i=r(a.a,o.a,!1,null,null,null);e.a=i.exports},501:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("b-container",{attrs:{fluid:""}},[s("b-row",[s("b-col",{staticClass:"my-1",attrs:{md:"1"}},[s("legend",{staticClass:"col-form-legend"},[t._v("每页显示：")])]),t._v(" "),s("b-col",{staticClass:"my-1",attrs:{md:"3"}},[s("b-form-group",[s("b-form-select",{attrs:{options:t.pageOptions},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1)],1),t._v(" "),s("b-col",{staticClass:"my-1",attrs:{md:"4"}}),t._v(" "),s("b-col",{staticClass:"my-1",attrs:{md:"4"}},[s("b-form-group",[s("b-input-group",[s("b-input-group-button",[s("div",{staticClass:"mt-2"},[t._v("\n              搜索：\n            ")])]),t._v(" "),s("b-form-input",{model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),t._v(" "),s("b-input-group-button",[s("b-button",{attrs:{variant:"danger",disabled:!t.filter},on:{click:function(e){t.filter=""}}},[t._v("重置")])],1)],1)],1)],1)],1),t._v(" "),s("b-table",{ref:"addStudentTable",attrs:{"show-empty":"",stacked:"md",striped:!0,fixed:!0,hover:!0,items:t.addStudentTable,fields:t.field,"current-page":t.currentPage,"per-page":t.perPage,filter:t.filter,"sort-by":t.sortBy,"sort-desc":t.sortDesc,isBusy:!1},on:{"update:sortBy":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},filtered:t.onFiltered},scopedSlots:t._u([{key:"index",fn:function(e){return[t._v("\n      "+t._s((t.currentPage-1)*t.perPage+1+e.index)+"\n    ")]}},{key:"actions",fn:function(e){return["credit"===t.mode?s("b-button",{staticClass:"btn btn-success",attrs:{size:"sm"},on:{click:function(t){t.stopPropagation(),e.toggleDetails(t)}}},[t._v("\n        修改学分上限\n      ")]):t._e(),t._v(" "),"student"===t.mode?s("b-button",{staticClass:"btn btn-success",attrs:{size:"sm"},on:{click:function(t){t.stopPropagation(),e.toggleDetails(t)}}},[t._v("\n        添加该学生\n      ")]):t._e()]}},{key:"row-details",fn:function(e){return["credit"===t.mode?s("b-card",[s("b-list-group",[s("b-list-group-item",{staticClass:"flex-column align-items-start",attrs:{title:"编辑学分",disabled:""}},[s("div",{staticClass:"d-flex w-100 justify-content-between"},[s("h5",{staticClass:"mb-1"},[t._v("学生 "),s("strong",[t._v(t._s(e.item.sname))]),t._v(" 的学分完成情况")]),t._v(" "),s("small",{staticClass:"text-muted"},[t._v("学生ID："+t._s(e.item.studentId))])]),t._v(" "),s("hr"),t._v(" "),s("div",{staticClass:"mr-1"},[s("dl",{staticClass:"row"},[s("dt",{staticClass:"col-sm-1"},[t._v("学分上限:")]),t._v(" "),s("dd",{staticClass:"col-sm-2"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.item.maxCredits,expression:"row.item.maxCredits"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],class:{"form-control":!0,"is-invalid":t.errors.has("maxCredits")},attrs:{id:"maxCredits",name:"maxCredits"},domProps:{value:e.item.maxCredits},on:{input:function(s){s.target.composing||t.$set(e.item,"maxCredits",s.target.value)}}}),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("maxCredits"),expression:"errors.has('maxCredits')"}],staticClass:"invalid-tooltip"},[t._v(t._s(t.errors.first("maxCredits"))+"\n                  ")])]),t._v(" "),s("dt",{staticClass:"col-sm-1"},[t._v("已完成学分:")]),t._v(" "),s("dd",{staticClass:"col-sm-2"},[t._v(t._s(e.item.complete))]),t._v(" "),s("dt",{staticClass:"col-sm-1"},[t._v("进行中学分:")]),t._v(" "),s("dd",{staticClass:"col-sm-2"},[t._v(t._s(e.item.progress))]),t._v(" "),s("dt",{staticClass:"col-sm-1"},[t._v("未完成学分:")]),t._v(" "),s("dd",{staticClass:"col-sm-2"},[t._v(t._s(e.item.incomplete))])]),t._v(" "),s("hr"),t._v(" "),s("dl",{staticClass:"row"},[s("dt",{staticClass:"col-sm-1"},[t._v("操作:")]),t._v(" "),s("dd",{staticClass:"col-sm-5"},[s("b-button",{staticClass:"btn btn-danger",attrs:{size:"sm"},on:{click:function(s){s.stopPropagation(),t.doUpdate(e.item.studentId,e.item.maxCredits)}}},[t._v("\n                    提交\n                  ")])],1)])])])],1)],1):t._e(),t._v(" "),"student"===t.mode?s("b-card",[s("b-list-group",[s("b-list-group-item",{staticClass:"flex-column align-items-start",attrs:{title:"添加该学生",disabled:""}},[s("div",{staticClass:"d-flex w-100 justify-content-between"},[s("h5",{staticClass:"mb-1"},[t._v("添加学生 "),s("strong",[t._v(t._s(e.item.sname))]),t._v(" 进入 "),s("strong",[t._v(t._s(t.cname))]),t._v(" 课程")]),t._v(" "),s("small",{staticClass:"text-muted"},[t._v("学生ID："+t._s(e.item.studentId))])]),t._v(" "),s("hr"),t._v(" "),s("div",{staticClass:"mr-1"},[s("h5",{staticClass:"mb-1"},[t._v("添加选项:")]),t._v(" "),s("dl",{staticClass:"row"},[s("dt",{staticClass:"col-sm-2"},[t._v("添加此学生，无视任何冲突:")]),t._v(" "),s("dd",{staticClass:"col-sm-1"},[s("div",{staticClass:"custom-control custom-checkbox custom-control-inline"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.option.override,expression:"option.override"}],staticClass:"custom-control-input",attrs:{type:"checkbox",value:"s",id:"override",name:"type"},domProps:{checked:Array.isArray(t.option.override)?t._i(t.option.override,"s")>-1:t.option.override},on:{change:function(e){var s=t.option.override,a=e.target,o=!!a.checked;if(Array.isArray(s)){var r=t._i(s,"s");a.checked?r<0&&(t.option.override=s.concat(["s"])):r>-1&&(t.option.override=s.slice(0,r).concat(s.slice(r+1)))}else t.$set(t.option,"override",o)}}}),t._v(" "),s("label",{staticClass:"custom-control-label",attrs:{for:"override"}},[t._v("是")])])]),t._v(" "),s("dt",{staticClass:"col-sm-2"},[t._v("添加此学生，即使未完成预选课程:")]),t._v(" "),s("dd",{staticClass:"col-sm-1"},[s("div",{staticClass:"custom-control custom-checkbox custom-control-inline"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.option.prereq,expression:"option.prereq"}],staticClass:"custom-control-input",attrs:{type:"checkbox",value:"s",id:"prereq",name:"type"},domProps:{checked:Array.isArray(t.option.prereq)?t._i(t.option.prereq,"s")>-1:t.option.prereq},on:{change:function(e){var s=t.option.prereq,a=e.target,o=!!a.checked;if(Array.isArray(s)){var r=t._i(s,"s");a.checked?r<0&&(t.option.prereq=s.concat(["s"])):r>-1&&(t.option.prereq=s.slice(0,r).concat(s.slice(r+1)))}else t.$set(t.option,"prereq",o)}}}),t._v(" "),s("label",{staticClass:"custom-control-label",attrs:{for:"prereq"}},[t._v("是")])])]),t._v(" "),s("dt",{staticClass:"col-sm-2"},[t._v("添加此学生，即使有时间冲突:")]),t._v(" "),s("dd",{staticClass:"col-sm-1"},[s("div",{staticClass:"custom-control custom-checkbox custom-control-inline"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.option.time,expression:"option.time"}],staticClass:"custom-control-input",attrs:{type:"checkbox",value:"s",id:"time",name:"type"},domProps:{checked:Array.isArray(t.option.time)?t._i(t.option.time,"s")>-1:t.option.time},on:{change:function(e){var s=t.option.time,a=e.target,o=!!a.checked;if(Array.isArray(s)){var r=t._i(s,"s");a.checked?r<0&&(t.option.time=s.concat(["s"])):r>-1&&(t.option.time=s.slice(0,r).concat(s.slice(r+1)))}else t.$set(t.option,"time",o)}}}),t._v(" "),s("label",{staticClass:"custom-control-label",attrs:{for:"time"}},[t._v("是")])])]),t._v(" "),s("dt",{staticClass:"col-sm-2"},[t._v("添加此学生，即使已经达到课程人数上限:")]),t._v(" "),s("dd",{staticClass:"col-sm-1"},[s("div",{staticClass:"custom-control custom-checkbox custom-control-inline"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.option.capacity,expression:"option.capacity"}],staticClass:"custom-control-input",attrs:{type:"checkbox",value:"s",id:"capacity",name:"type"},domProps:{checked:Array.isArray(t.option.capacity)?t._i(t.option.capacity,"s")>-1:t.option.capacity},on:{change:function(e){var s=t.option.capacity,a=e.target,o=!!a.checked;if(Array.isArray(s)){var r=t._i(s,"s");a.checked?r<0&&(t.option.capacity=s.concat(["s"])):r>-1&&(t.option.capacity=s.slice(0,r).concat(s.slice(r+1)))}else t.$set(t.option,"capacity",o)}}}),t._v(" "),s("label",{staticClass:"custom-control-label",attrs:{for:"capacity"}},[t._v("是")])])])]),t._v(" "),s("hr"),t._v(" "),s("dl",{staticClass:"row"},[s("dt",{staticClass:"col-sm-1"},[t._v("操作:")]),t._v(" "),s("dd",{staticClass:"col-sm-5"},[s("b-button",{staticClass:"btn btn-danger",attrs:{size:"sm"},on:{click:function(s){s.stopPropagation(),t.addStudent2Course(e.item.studentId)}}},[t._v("\n                    添加\n                  ")])],1)])])])],1)],1):t._e()]}}])}),t._v(" "),s("b-row",[s("b-col",{staticClass:"my-1",attrs:{md:"6"}},[s("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1),t._v(" "),s("b-col",{staticClass:"my-1",attrs:{md:"6"}},[s("p",{staticClass:"text-muted",staticStyle:{"text-align":"right"}},[t._v(" 显示 "+t._s((t.currentPage-1)*t.perPage+1)+" 至 "+t._s((t.currentPage-1)*t.perPage+t.perPage<=t.totalRows?(t.currentPage-1)*t.perPage+t.perPage:t.totalRows)+" 条 ，总共 "+t._s(t.totalRows)+" 条数据 ")])])],1),t._v(" "),s("b-modal",{attrs:{size:"sm","header-bg-variant":t.headerBgVariant,"ok-only":"","ok-title":"关闭",centered:"",title:"消息"},on:{ok:t.handleOk},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[s("div",{staticClass:"d-block text-center"},[s("h4",[t._v(t._s(t.msg))])])])],1)},o=[],r={render:a,staticRenderFns:o};e.a=r},657:function(t,e,s){"use strict";var a=s(500);e.a={name:"Credit",components:{CAddStudentTable:a.a}}},766:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"animated fadeIn"},[s("b-row",[s("b-col",{attrs:{md:"12"}},[s("b-col",{attrs:{cols:"12"}},[s("b-card",{attrs:{"header-tag":"header","footer-tag":"footer"}},[s("div",{attrs:{slot:"header"},slot:"header"},[s("i",{attrs:{className:"fa fa-align-justify"}}),s("strong",[t._v("学生列表")])]),t._v(" "),s("CAddStudentTable",{attrs:{mode:"credit"}})],1)],1)],1)],1)],1)},o=[],r={render:a,staticRenderFns:o};e.a=r}});
//# sourceMappingURL=17.c02a6f8f405ebc471d92.js.map