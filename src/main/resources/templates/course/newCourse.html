<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:v-on="http://www.w3.org/1999/xhtml">

<head th:include="/common :: header('新课程申请管理',true, false)"></head>
<body>
<div id="wrapper">
    <!--/. NAV TOP  -->
    <div th:include="/common :: navtop" class="sidebar-collapse"></div>

    <!-- /. NAV SIDE  -->
    <div th:include="/common :: navbar" class="sidebar-collapse"></div>
    <div id="page-wrapper">
        <div id="coursePage">
            <div class="header">
                <h1 class="page-header">
                    先锋课程系统
                    <small>新课程申请管理</small>
                </h1>
                <ol class="breadcrumb">
                    <li><a href="/index">主页</a></li>
                    <li><a href="#">课程系统</a></li>
                    <li class="active">新课程申请管理</li>
                </ol>

            </div>
            <div id="page-inner">
                <div class="row">
                    <div class="col-md-12" v-show="table">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                课程列表
                            </div>
                            <div class="panel-body">
                                <table class="table table-striped table-bordered table-hover" id="courseTable"></table>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-12" v-show="detail">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <button class="btn btn-primary btn-info" type="button" v-on:click="showCourseTable">
                                    <i class="fa fa-arrow-left"></i> 返回列表
                                </button>
                                课程详情
                            </div>
                            <div class="panel-body">
                                <div class="panel-group" id="accordion">
                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                        <span style="cursor: pointer" data-toggle="collapse" data-parent="#accordion"
                                              href="#collapseOne">课程信息详情</span>
                                        </div>
                                        <div id="collapseOne" class="panel-collapse in" style="height: auto;"
                                             v-if="detail">
                                            <div class="panel-body">
                                                <form class="form-horizontal" id="createCourseForm"
                                                      onclick="return false;">
                                                    <div class="col-md-12 col-sm-4">
                                                        <div class="panel panel-danger">
                                                            <div class="panel-heading">
                                                                学期信息
                                                            </div>
                                                            <div class="form-group panel-body">
                                                                <div class="col-sm-2">
                                                                    <label for="year-semester"
                                                                           class="col-sm-12 control-label">*年份-学期(YYYY-XX):</label>
                                                                </div>
                                                                <div class="col-sm-3">
                                                                    <input id="year-semester" class="form-control"
                                                                           required
                                                                           disabled v-model="course.info"/>
                                                                </div>
                                                                <div class="col-sm-2">
                                                                    <label for="crn"
                                                                           class="col-sm-12 control-label">*课程CRN:</label>
                                                                </div>
                                                                <div class="col-sm-3">
                                                                    <input id="crn" class="form-control" required
                                                                           disabled
                                                                           v-if="course.crn"/>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12 col-sm-4">
                                                        <div class="panel panel-info">
                                                            <div class="panel-heading">
                                                                课程基本信息
                                                            </div>
                                                            <div class="panel-body">
                                                                <div class="form-group">
                                                                    <div class="col-sm-2">
                                                                        <label for="name"
                                                                               class="col-sm-12 control-label">*课程名:</label>
                                                                    </div>
                                                                    <div class="col-sm-3">
                                                                        <input id="name" class="form-control"
                                                                               minlength="1"
                                                                               maxlength="20"
                                                                               required v-model="course.name"/>
                                                                    </div>
                                                                    <div class="col-sm-2">
                                                                        <label for="coulev"
                                                                               class="col-sm-12 control-label">*课程等级:</label>
                                                                    </div>
                                                                    <div class="col-sm-3">
                                                                        <input id="coulev" isDigits="true"
                                                                               class="form-control"
                                                                               placeholder="*100-499" minlength="3"
                                                                               maxlength="3" required
                                                                               v-model="course.level"/>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <div class="col-sm-2">
                                                                        <label for="cousec"
                                                                               class="col-sm-12 control-label">*课程班级:</label>
                                                                    </div>
                                                                    <div class="col-sm-3">
                                                                        <input id="cousec" class="form-control"
                                                                               placeholder="*01,02,03..."
                                                                               minlength="2" maxlength="2" required
                                                                               v-model="course.section"/>
                                                                    </div>
                                                                    <div class="col-sm-2">
                                                                        <label for="credits"
                                                                               class="col-sm-12 control-label">*学分:</label>
                                                                    </div>
                                                                    <div class="col-sm-3">
                                                                        <input id="credits" isDigits="true"
                                                                               placeholder="*0-4"
                                                                               class="form-control" minlength="1"
                                                                               maxlength="1" required
                                                                               v-model="course.credits"/>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <div class="col-sm-2">
                                                                        <label for="capa"
                                                                               class="col-sm-12 control-label">*课程容量:</label>
                                                                    </div>
                                                                    <div class="col-sm-3">
                                                                        <input id="capa" isDigits="true"
                                                                               class="form-control" required
                                                                               v-model="course.capacity"/>
                                                                    </div>
                                                                    <div class="col-sm-2">
                                                                        <label for="classroom"
                                                                               class="col-sm-12 control-label">教室:</label>
                                                                    </div>
                                                                    <div class="col-sm-3">
                                                                        <input id="classroom" class="form-control"
                                                                               maxlength="20"
                                                                               v-model="course.classroom"/>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <div class="col-sm-2">
                                                                        <label for="startdate"
                                                                               class="col-sm-12 control-label">*开始日期:</label>
                                                                    </div>
                                                                    <div class="col-sm-3">
                                                                        <input id="startdate" class="form-control"
                                                                               required v-model="course.startDate"/>
                                                                    </div>
                                                                    <div class="col-sm-2">
                                                                        <label for="enddate"
                                                                               class="col-sm-12 control-label">*结束日期:</label>
                                                                    </div>
                                                                    <div class="col-sm-3">
                                                                        <input id="enddate" class="form-control"
                                                                               required
                                                                               v-model="course.endDate"/>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <div class="col-sm-2">
                                                                        <label for="starttime"
                                                                               class="col-sm-12 control-label">*开始时间:</label>
                                                                    </div>
                                                                    <div class="col-sm-3">
                                                                        <input id="starttime" class="form-control"
                                                                               required v-model="course.startTime"/>
                                                                    </div>
                                                                    <div class="col-sm-2">
                                                                        <label for="endtime"
                                                                               class="col-sm-12 control-label">*结束时间:</label>
                                                                    </div>
                                                                    <div class="col-sm-3">
                                                                        <input id="endtime" class="form-control"
                                                                               required
                                                                               v-model="course.endTime"/>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <div class="col-sm-2">
                                                                        <label class="col-sm-12 control-label">*选择上课的时间:</label>
                                                                    </div>
                                                                    <div class="col-sm-8">
                                                                        <div class="checkbox3 checkbox-danger checkbox-inline checkbox-check  checkbox-circle checkbox-light">
                                                                            <input type="checkbox" value="m" id="m"
                                                                                   name="day" v-model="courseDay">
                                                                            <label for="m">星期一</label>
                                                                        </div>
                                                                        <div class="checkbox3 checkbox-danger checkbox-inline checkbox-check  checkbox-circle checkbox-light">
                                                                            <input type="checkbox" value="t" id="t"
                                                                                   name="day" v-model="courseDay">
                                                                            <label for="t">星期二</label>
                                                                        </div>
                                                                        <div class="checkbox3 checkbox-danger checkbox-inline checkbox-check  checkbox-circle checkbox-light">
                                                                            <input type="checkbox" value="w" id="w"
                                                                                   name="day" v-model="courseDay">
                                                                            <label for="w">星期三</label>
                                                                        </div>
                                                                        <div class="checkbox3 checkbox-danger checkbox-inline checkbox-check  checkbox-circle checkbox-light">
                                                                            <input type="checkbox" value="tr" id="tr"
                                                                                   name="day" v-model="courseDay">
                                                                            <label for="tr">星期四</label>
                                                                        </div>
                                                                        <div class="checkbox3 checkbox-danger checkbox-inline checkbox-check  checkbox-circle checkbox-light">
                                                                            <input type="checkbox" value="f" id="f"
                                                                                   name="day" v-model="courseDay">
                                                                            <label for="f">星期五</label>
                                                                        </div>
                                                                        <div class="checkbox3 checkbox-danger checkbox-inline checkbox-check  checkbox-circle checkbox-light">
                                                                            <input type="checkbox" value="sa" id="sa"
                                                                                   name="day" v-model="courseDay">
                                                                            <label for="sa">星期六</label>
                                                                        </div>
                                                                        <div class="checkbox3 checkbox-danger checkbox-inline checkbox-check  checkbox-circle checkbox-light">
                                                                            <input type="checkbox" value="s" id="s"
                                                                                   name="day" v-model="courseDay">
                                                                            <label for="s">星期日</label>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="panel-footer">
                                                                注意：*为必填项，其余选填。
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12 col-sm-4">
                                                        <div class="panel panel-success">
                                                            <div class="panel-heading">
                                                                教师与预选课分配
                                                            </div>
                                                            <div class="panel-body">
                                                                <div class="form-group">
                                                                    <div class="col-sm-2">
                                                                        <label class="col-sm-12 control-label">*分配教师:</label>
                                                                    </div>
                                                                    <div id="selectF" class="col-sm-8">
                                                                        <select style="width: 75%" id="searchFValue"
                                                                                class="js-example-basic-single"
                                                                                name="state">
                                                                        </select>
                                                                        <button style="float: right; width: 20%;"
                                                                                class="btn btn-danger cancel">取消
                                                                        </button>
                                                                    </div>
                                                                    <div id="faculty" class="col-sm-8">
                                                                        <h4 style="width: 50%; padding-top: 0;  float: left"
                                                                            id="facultyInfo"></h4>
                                                                        <button id="update" class="btn btn-primary"
                                                                                style=" width: 50%; margin-top: 0.5%;">
                                                                            更新教师
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <div class="col-sm-2">
                                                                        <label class="col-sm-12 control-label">*预选课程（可以多选，也可不选）:</label>
                                                                    </div>
                                                                    <div id="selectC" class="col-sm-8">
                                                                        <select style="width: 75%" id="searchCValue"
                                                                                class="js-example-basic-multiple"
                                                                                name="states[]" multiple="multiple">
                                                                        </select>
                                                                        <button style="float: right; width: 20%;"
                                                                                class="btn btn-danger" id="cancel">取消
                                                                        </button>
                                                                    </div>
                                                                    <div id="course" class="col-sm-8">
                                                                        <h4 style="width: 50%; padding-top: 0;  float: left"
                                                                            id="preCourseInfo"></h4>
                                                                        <button id="updateC" class="btn btn-primary"
                                                                                style=" width: 50%; margin-top: 0.5%;">
                                                                            更新预选课程
                                                                        </button>
                                                                    </div>
                                                                </div>

                                                            </div>
                                                            <div class="panel-footer">
                                                                注意：教师为必填
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12 col-sm-4">
                                                        <div class="panel panel-default">
                                                            <div class="panel-body">
                                                                <div class="form-group">
                                                                    <div class="col-sm-2">
                                                                        <label for="password"
                                                                               class="col-sm-12 control-label">备注信息:</label>
                                                                    </div>

                                                                    <div class="col-sm-8">
                                                                    <textarea style="resize: none;" class="form-control"
                                                                              id="comments" rows="3"
                                                                              v-model="course.comment"></textarea>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <div class="col-sm-2">
                                                                        <label for="password"
                                                                               class="col-sm-12 control-label">*请确认上述信息正确无误:</label>
                                                                    </div>
                                                                    <div class="col-sm-3">
                                                                        <div id="yes-div"
                                                                             class="checkbox3 checkbox-danger checkbox-inline checkbox-check  checkbox-circle checkbox-light">
                                                                            <input type="checkbox" id="yes"
                                                                                   name="confirm"
                                                                                   required>
                                                                            <label for="yes">确认</label>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-sm-2">
                                                                        <label for="password"
                                                                               class="col-sm-12 control-label">*管理员操作密码:</label>
                                                                    </div>
                                                                    <div class="col-sm-3">
                                                                        <input type="password" id="password"
                                                                               class="form-control" minlength="6"
                                                                               maxlength="16" checkOpPwd="true"
                                                                               required/>
                                                                    </div>
                                                                    <button style="width:150px;" class="btn btn-primary"
                                                                            v-if="pageMode='view'">修改课程
                                                                    </button>
                                                                    <button style="width:150px;" class="btn btn-primary"
                                                                            v-if="pageMode='create'">创建课程
                                                                    </button>
                                                                    <button style="width:150px;" class="btn btn-primary"
                                                                            v-if="pageMode='request'">提交申请
                                                                    </button>
                                                                </div>
                                                                <div class="panel-footer">
                                                                    注意：操作密码不是登录密码
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </form>

                                            </div>
                                        </div>
                                    </div>
                                    <div class="panel panel-default" v-show="pageMode='student'">
                                        <div class="panel-heading">
                                        <span style="cursor: pointer" data-toggle="collapse" data-parent="#accordion"
                                              href="#collapseTwo" class="collapsed">课程学生详情</span>
                                        </div>
                                        <div id="collapseTwo" class="panel-collapse collapse">
                                            <div class="panel-body">
                                                <div class="col-md-7 col-sm-4">
                                                    <table style="width:100%" id="studentTable"
                                                           class="table table-striped table-bordered table-hover"></table>
                                                </div>
                                                <form id="editTranscript" class="form-group" method="post"
                                                      onsubmit="return false">
                                                    <div id="transcript" class="col-md-5 col-sm-4">
                                                        <div class="panel panel-info">
                                                            <div class="panel-heading">
                                                                学生成绩详情
                                                            </div>
                                                            <div class="panel-body">
                                                                <div class="form-group">
                                                                    <div class="col-sm-3">
                                                                        <label for="sid"
                                                                               class="col-sm-12 control-label">学生ID:</label>
                                                                    </div>
                                                                    <div class="col-sm-9">
                                                                        <input id="sid" value="" class="form-control"
                                                                               disabled>
                                                                    </div>
                                                                    <div class="col-sm-3" style="margin-top:10px;">
                                                                        <label for="crn"
                                                                               class="col-sm-12 control-label">*课程CRN:</label>
                                                                    </div>
                                                                    <div class="col-sm-9" style="margin-top:10px;">
                                                                        <input id="crn2" class="form-control" required
                                                                               disabled/>
                                                                    </div>
                                                                    <div class="col-sm-3" style="margin-top:10px;">
                                                                        <label for="crn"
                                                                               class="col-sm-12 control-label">*课程学分:</label>
                                                                    </div>
                                                                    <div class="col-sm-9" style="margin-top:10px;">
                                                                        <input id="credits2" class="form-control"
                                                                               required
                                                                               disabled/>
                                                                    </div>
                                                                    <div class="col-sm-3" style="margin-top:10px;">
                                                                        <label for="crn"
                                                                               class="col-sm-12 control-label">*成绩:</label>
                                                                    </div>
                                                                    <div class="col-sm-9" style="margin-top:10px;">
                                                                        <input placeholder="可使用Letter Grade或百分制"
                                                                               id="grade"
                                                                               name="grade" value=""
                                                                               class="form-control"
                                                                               minlength="1" required>
                                                                    </div>

                                                                    <div class="col-sm-3" style="margin-top:10px;">
                                                                        <label for="crn"
                                                                               class="col-sm-12 control-label">*完成情况:</label>
                                                                    </div>
                                                                    <div class="col-sm-9" style="margin-top:10px;">
                                                                        <input id="complete" type="radio"
                                                                               name="complete"
                                                                               value="Complete">完成
                                                                        <input id="process" type="radio" name="complete"
                                                                               value="In Progress">正在进行
                                                                        <input id="nComplete" type="radio"
                                                                               name="complete"
                                                                               value="Not Complete">未完成
                                                                    </div>
                                                                </div>
                                                                <div class="col-sm-3" style="margin-top:10px;">
                                                                    <label for="tPassword"
                                                                           class="col-sm-12 control-label">*管理员操作密码:</label>
                                                                </div>
                                                                <div class="col-sm-9" style="margin-top:10px;">
                                                                    <input type="password" id="tPassword"
                                                                           class="form-control" minlength="6"
                                                                           maxlength="16" checkOpPwd="true" required/>
                                                                </div>
                                                                <div class="col-sm-6" style="margin-top:10px;">
                                                                    <button class="col-sm-12 btn btn-primary btn-sucess"
                                                                            id="tUpdate">更新
                                                                    </button>
                                                                </div>


                                                                <div class="col-sm-6" style="margin-top:10px;">
                                                                    <button id="cancel2"
                                                                            class="col-sm-12 btn btn-primary btn-danger">
                                                                        取消
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="panel panel-default" v-show="pageMode='student'">
                                        <div class="panel-heading">
                                        <span style="cursor: pointer" data-toggle="collapse" data-parent="#accordion"
                                              href="#collapseThree" class="collapsed">添加学生</span>
                                        </div>
                                        <div id="collapseThree" class="panel-collapse collapse">
                                            <div class="panel-body">
                                                <div class="col-md-8 col-sm-4">
                                                    <table style="width:100%" id="userTable"
                                                           class="table table-striped table-bordered table-hover"></table>
                                                </div>
                                                <div class="col-md-4 col-sm-4">
                                                    <div id="assignSDiv" class="group-form-input">
                                                        <h4 class="status" style="margin-top: 0px;">添加选项: </h4>
                                                        <table style="font-size: 11px">
                                                            <tr>
                                                                <td style="color: red;font-weight: 900;margin-bottom: -5px">
                                                                    <input type="checkbox" name="pre"
                                                                           style="height: 14px; font-size:15px; margin: 10px 4px 10px 0; width: 12px;">
                                                                    添加此学生，即使未完成预选课程
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="color: red;font-weight: 900;">
                                                                    <input type="checkbox" name="time"
                                                                           style="height: 14px; font-size:15px;margin: 10px 4px 10px 0; width: 12px;">
                                                                    添加此学生，即使有时间冲突
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="color: red;font-weight: 900;">
                                                                    <input type="checkbox" name="capa"
                                                                           style="height: 14px; font-size:15px;margin: 10px 4px 10px 0; width: 12px;">
                                                                    添加此学生，即使已经达到课程人数上限
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="panel-footer" id=footerPlaceholder">
                <div th:include="/common :: footer" id="copyright"></div>
            </div>
            <!-- /. PAGE INNER  -->
        </div>
    </div>
    <!-- /. PAGE WRAPPER  -->
</div>
<!-- /. WRAPPER  -->
<div th:include="/common/js :: load_js(true , false, false)"></div>
<script>
    let courseTable;
    let studentTable;
    let userTable;
    let courseVue = new Vue({
        el: '#coursePage',
        data: {
            courseList: [],
            course: {
                crn: "",
                info: "",
                name: "",
                credits: "",
                level: "",
                section: "",
                startDate: "",
                endDate: "",
                startTime: "",
                endTime: "",
                capacity: "",
                classroom: "",
                comment: "",
                day: "",
                precrn: "",
                facultyId: "",
                faculty: "",
                remain: ""
            },
            courseDay: [],
            preList: [],
            table: true,
            detail: false,
            pageMode: location.search.split("&")[0].split("=")[1],//location.search获取url中的?后的字符串
        },
        mounted: function () {
            //执行一个laydate实例
            laydate.render({
                elem: '#startdate',
                theme: '#393D49',
                showBottom: false,
                done: (value) => {
                    this.course.startDate = value
                }
            });
            laydate.render({
                elem: '#enddate',
                theme: '#393D49',
                showBottom: false,
                done: (value) => {
                    this.course.endDate = value
                }
            });
            laydate.render({
                elem: '#starttime',
                theme: '#393D49',
                type: 'time',
                min: '06:00:00',
                max: '22:00:00',
                showBottom: false,
                done: (value) => {
                    this.course.startTime = value
                }
            });
            laydate.render({
                elem: '#endtime',
                theme: '#393D49',
                type: 'time',
                min: '06:00:00',
                max: '22:00:00',
                showBottom: false,
                done: (value) => {
                    this.course.endTime = value
                }
            });
        },
        methods: {
            showCourseTable: function () {
                this.table = true;
                this.detail = false;
            }
        }
    });

    function deleteCourse(crn) {
        Showbo.Msg.confirm("确认删除该课程？", function () {
            if ($(".btnfocus").val() !== "取消") {
                /*删除操作*/
                axios.delete('/course/' + crn).then(function (response) {
                    if (response.data.code === 2001)
                        Showbo.Msg.alert("删除成功!", function () {
                            logTable.draw();
                        });
                    else
                        Showbo.Msg.alert(response.data.msg, function () {
                        });
                });
            }
        });
    }

    function showCourseDetail(col) {

        courseVue.$data.course = courseVue.$data.courseList[col];
        courseVue.$data.courseDay = courseVue.$data.course.day.split("/");
        courseVue.$data.preList = courseVue.$data.course.precrn.split("/");

        courseVue.$data.table = false;
        courseVue.$data.detail = true;

        studentTable = $("#studentTable").DataTable({

            "language": {
                "aria": {
                    "sortAscending": ": activate to sort column ascending",
                    "sortDescending": ": activate to sort column descending"
                },
                "emptyTable": "没有数据！",
                "info": "显示 _START_ 至 _END_ 条 ，总共_TOTAL_ 条数据",
                "infoEmpty": "没有发现记录！",
                "infoFiltered": "(从_MAX_条记录中搜索)",
                "lengthMenu": "显示: _MENU_",
                "search": "搜索:",
                "zeroRecords": "没有找到匹配的记录！",
                "paginate": {
                    "previous": "上一页",
                    "next": "下一页",
                    "last": "尾页",
                    "first": "首页"
                }
            },
            "pagingType": "full_numbers",
            "lengthMenu": [
                [5, 10, 15],
                [5, 10, 15]
            ],
            pageLength: 5,
            processing: true,
            serverSide: true,

            ajax: {
                url: basePath + "/transcript/" + courseVue.$data.course.crn + "/student",
            },
            columns: [
                {"data": "studentId", "title": "学生ID"},
                {"data": "sname", "title": "学生名"},
                {"data": "grade", "title": "学生成绩"},
                {
                    "data": "complete", "title": "完成情况", "createdCell": function (nTd, rowData) {
                    if (rowData === "1")
                        $(nTd).html('<p style="line-height: 1.42857143; padding-top: 0; color:green; ">完成</p>');
                    else if (rowData === "0")
                        $(nTd).html('<p style="line-height: 1.42857143; padding-top: 0; color:blue; ">进行中</p>');
                    else if (rowData === "-1")
                        $(nTd).html('<p style="line-height: 1.42857143; padding-top: 0; color:red; ">挂科</p>');
                }
                },
                {
                    "data": null, "title": "操作", "createdCell": function (nTd) {
                    $(nTd).html('<button style="width: 50%" class="btn btn-success">修改成绩</button><button style="width: 50%" class="btn btn-danger">移除</button>');
                }, "width": "10px"
                }
            ],
            "columnDefs": [{
                orderable: false,
                targets: [4]
            }, {
                "defaultContent": "",
                "targets": "_all"
            }]
        });


    }

    $(function () {
        courseTable = $("#courseTable").DataTable({

            "language": {
                "aria": {
                    "sortAscending": ": activate to sort column ascending",
                    "sortDescending": ": activate to sort column descending"
                },
                "emptyTable": "没有数据！",
                "info": "显示 _START_ 至 _END_ 条 ，总共_TOTAL_ 条数据",
                "infoEmpty": "没有发现记录！",
                "infoFiltered": "(从_MAX_条记录中搜索)",
                "lengthMenu": "显示: _MENU_",
                "search": "搜索:",
                "zeroRecords": "没有找到匹配的记录！",
                "paginate": {
                    "previous": "上一页",
                    "next": "下一页",
                    "last": "尾页",
                    "first": "首页"
                }
            },
            "pagingType": "full_numbers",
            "lengthMenu": [
                [5, 10, 15, 20],
                [5, 10, 15, 20]
            ],
            pageLength: 10,
            processing: true,
            serverSide: true,

            ajax: {
                url: basePath + "/course"
            },
            columns: [
                {"data": "crn", "title": "编号"},
                {"data": "name", "title": "课程名"},
                {"data": "level", "title": "等级"},
                {"data": "section", "title": "班级"},
                {"data": "capacity", "title": "容量"},
                {"data": "remain", "title": "剩余"},
                {
                    "data": "status", "title": "状态", "createdCell": function (nTd, rowData) {
                    if (rowData === 1)
                        $(nTd).html('<p style="line-height: 1.42857143; padding-top: 0; color:blue; ">未开始</p>');
                    else if (rowData === 0)
                        $(nTd).html('<p style="line-height: 1.42857143; padding-top: 0; color:green; ">进行中</p>');
                    else if (rowData === -1)
                        $(nTd).html('<p style="line-height: 1.42857143; padding-top: 0; color:red; ">已结课</p>');
                }
                },
                {"data": "date", "title": "起止时间"},
                {"data": "time", "title": "上课时间"},
                {"data": "day", "title": "星期"},
                {"data": "faculty", "title": "授课老师"},
                {"data": "updateTime", "title": "更新时间"},
                {
                    "data": "crn", "title": "操作", "createdCell": function (nTd, rowData, row, col) {
                    $(nTd).html('<button style="width: 50%" class="btn btn-danger" onclick="deleteCourse(\'' + rowData + '\')">删除课程</button>' +
                        '<button style="width: 50%" class="btn btn-info" onclick="showCourseDetail(\'' + col + '\')">查看详情</button>');
                    courseVue.$data.courseList.push(row);
                }
                }
            ],
            "columnDefs": [{
                orderable: false,
                targets: [12]
            }, {
                "defaultContent": "",
                "targets": "_all"
            }]
        });

        userTable = $("#userTable").DataTable({
            "language": {
                "aria": {
                    "sortAscending": ": activate to sort column ascending",
                    "sortDescending": ": activate to sort column descending"
                },
                "emptyTable": "没有数据！",
                "info": "显示 _START_ 至 _END_ 条 ，总共_TOTAL_ 条数据",
                "infoEmpty": "没有发现记录！",
                "infoFiltered": "(从_MAX_条记录中搜索)",
                "lengthMenu": "显示: _MENU_",
                "search": "搜索:",
                "zeroRecords": "没有找到匹配的记录！",
                "paginate": {
                    "previous": "上一页",
                    "next": "下一页",
                    "last": "尾页",
                    "first": "首页"
                }
            },
            "pagingType": "full_numbers",
            "lengthMenu": [
                [5],
                [5]
            ],
            pageLength: 5,
            processing: true,
            serverSide: true,

            ajax: {
                url: basePath + "/student",
                data: function (d) {
                    d.status = "1";
                }
            },
            columns: [
                {"data": "studentId", "title": "学生ID"},
                {"data": "sname", "title": "姓名"},
                {"data": "maxCredits", "title": "学分上限"},
                {"data": "complete", "title": "已完成"},
                {"data": "progress", "title": "进行中"},
                {"data": "incomplete", "title": "未完成"},
                {
                    "data": null, "title": "操作", "createdCell": function (nTd) {
                    $(nTd).html('<button style="width: 100%" class="btn btn-info">添加</button>');
                }, "width": "100px"
                }
            ],
            "columnDefs": [{
                orderable: false,
                targets: [6]
            }, {
                "defaultContent": "",
                "targets": "_all"
            }]
        });

    });

</script>
</body>
</html>
